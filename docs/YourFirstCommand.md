# Пособие по созданию команд
Команда — это слово или фраза, которая сигнализирует о том, что необходимо выполнить заранее созданные инструкции. Выполнить слэш-команду — означает отреагировать на действия пользователя вызвавшего её — выполнить код и обязательно отправить ответ.
  
Все команды находятся по пути `~/src/commands`. Это JavaScript файлы, которые автоматически импортируются. Каждый из них обязан экспортировать класс с именем `Command`. Об этом далее. 
  
Список доступных команд хранится на стороне Дискорда и чтобы эти команды отображались, этот список требуется обновлять: см. скрипт `~/scripts/refreshCommands`  
## Терминология
**Interaction** — взаимодействие. Контекст содержащий максимально возможные данные о взаимодействии пользователя с командой, кнопкой или модальным окном.  
**Slash** — слэш-команда.  
**Component** — кнопка, или подобный кнопке элемент с которым может работать пользователь.  
**Modal** — всплывающее окно, которое можно вызвать ответом на взаимодействие.
## Тело команды 
На момент v1.0 основа команды состоит из двух методов: `onSlashInteraction` & `onComponentInteraction` и одного статического свойства хранящего параметры — `options`.
```js
class Command extends BaseCommand {
  constructor(){
  }

  onSlashInteraction(interaction){
  }

  onComponentInteraction(interaction){
  }

  static options = {
    name: "<NAME>",
    description: "<DESCRIPTION>"
  }
}
export { Command };
```
_В каталоге `commands` находится файл `.snippet.js` — это минимальный фрагмент кода. Его рекомендуется брать за основу при создании новых команд._


## Как отправить ответ
Повторюсь, ответ отправить надо.  
Отправка происходит через взаимодействие с объектом `interaction`. Вам нужно отправить сообщение или отобразить модальное окно.  
Минимальный пример:  
```js
const message = { content: "hello, world" };
interaction.reply(message);
```
Используйте утилиту [`CreateMessage`]() для генерации сообщений!

## Как создать компонент
Компоненты можно прикрепить к сообщению или к модельному окну. В обоих случаях требуется установить "строку компонентов".  
При использовании `CreateMessage` и `CreateModal` это происходит автоматически.  
  
Компоненты имеют специфичные свойства, которые должны быть указаны. Найти их список можно [по ссылке](https://discord.com/developers/docs/interactions/message-components).
```js
const component = {
  type: ComponentType,
  customId: "@command/.snippet/example:(0)"
  // ...другие свойства 
}
CreateMessage({
  //...
  components: component
})
```
Если Вы хотите передать несколько компонентов, оберните их в массив.  
  
Обязательное поле **customId** содержит информацию для будущей обработки взаимодействия.  
Так, для вызова `onComponentInteraction` необходимо, чтобы `customId` начинался строкой `@command/<имя_команды>`.  

## Советы по стилю кода
- Храните всю логику во вне. Рассматривайте команды как средство обработки взаимодействий в формате вопрос-ответ.
- Генерацию сообщений по возможности стоит выносить в отдельную/отдельные функции. 
 
## Несколько нюансов:
\*Стартовая точка приложения, которая получает данные об взаимодействии — это событие получаемое в `app.client.on()`, "createInteraction". Данные передаются в обработчик `~/events/interactionCreate.js`, который по возможности вызывает один из методов: `onSlashInteraction` или `onComponentInteraction` соответствующей команды.  
  
\*`CreateMessage` и `CreateModal` для трансформации компонентов используют утилиту `SimplifyComponents`.

\*Вы можете обернуть список компонентов во второй по вложенности массив. Обратите на это внимание, если требуется добавить "строку компонентов".
